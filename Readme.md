Берем заготовку из https://github.com/mgcrp/hse_se_dwh_course_2024/tree/master/week02/sem/demo2_automated_replication    
Создаем папку init-script\init - ее мы замаунтим в /docker-entrypoint-initdb.d, чтобы ее содержимое исполнилось  
В ней создадим скрипт 1_initdb.sql, который создаст таблички БД и материализует требуемый запрос (начинается с 1, чтобы точно раньше исполнился).  
Также создадим в этой папке файл init.sh - он тоже будет исполнен при первом запуске.   
Он запустит init-script/init.sh - изначальный файл-запускатор из заготовки, который добавит пользователя, слот, сделает бекап и скопирует конфиги  
После этого он создаст файлик ready.txt - своеобразный флаг того, что мастер готов, после чего убьет главный процесс мастера (отправит его на рестарт)  
В докер-компоузе прописано, что мастера, если он убит, надо оживить.  
У мастера прописан хелсчек - процесс считается healthy если файл ready.txt существует и база на мастере работает  
Слейв запустится только если мастер healthy, то есть если он полностью настроен.  
Таким образом, по docker-compose up -d вся конструкция успешно запускается   
